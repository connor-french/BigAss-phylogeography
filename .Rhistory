se = FALSE,
col = "red",
lty = 2,
lwd = .25,
alpha = .5
)
mars_model_25$finalModel
### 50 predictor model -----
mars_model_50 <- caret::train(
x = predictors_50,
y = responses$hill.one.avg,
method = "earth",
tuneGrid = mars_grid,
trControl = ctrl
)
warnings()
# average RMSE plot
ggplot(mars_model_50) +
theme(legend.position = "top")
# obs vs predicted plot
mars_model_pred_50 <- mars_model_50$pred
ggplot(mars_model_pred_50, aes(x = pred, y = obs)) +
geom_abline(col = "green", alpha = .5) +
geom_hex(alpha = .8) +
scale_fill_viridis_c() +
geom_smooth(
se = FALSE,
col = "red",
lty = 2,
lwd = .25,
alpha = .5
)
mars_model_50$finalModel
# set up tuning grid. We're exploring additive and interaction terms ("degree"),
rf_grid <- expand.grid(.mtry = 1:sqrt(ncol(predictors)))
set.seed(8445)
rf_model <- caret::train(
x = predictors,
y = responses$mean.pi.avg,
method = "rf",
tuneGrid = rf_grid,
trControl = ctrl,
ntree = 1000
)
set.seed(8445)
rf_model <- caret::train(
x = predictors,
y = responses$hill.one.avg,
method = "rf",
tuneGrid = rf_grid,
trControl = ctrl,
ntree = 1000
)
warnings()
rf_model$results
rf_model$finalModel
# average RMSE plot
ggplot(rf_model) +
theme(legend.position = "top")
# obs vs predicted plot
rf_model_pred <- rf_model$pred
ggplot(rf_model_pred, aes(x = pred, y = obs)) +
geom_abline(col = "green", alpha = .5) +
geom_hex(alpha = .8) +
scale_fill_viridis_c() +
geom_smooth(
se = FALSE,
col = "red",
lty = 2,
lwd = .25,
alpha = .5
)
rf_grid_5 <- expand.grid(.mtry = 1:ncol(predictors))
rf_grid_5 <- expand.grid(.mtry = 1:ncol(predictors))
set.seed(348)
rf_model_5 <- caret::train(
x = predictors_5,
y = responses$hill.one.avg,
method = "rf",
tuneGrid = rf_grid,
trControl = ctrl,
ntree = 1000
)
rf_model_5$results
# average RMSE plot
ggplot(rf_model_5) +
theme(legend.position = "top")
# obs vs predicted plot
rf_model_5_pred <- rf_model_5$pred
ggplot(rf_model_5_pred, aes(x = pred, y = obs)) +
geom_abline(col = "green", alpha = .5) +
geom_hex(alpha = .8) +
scale_fill_viridis_c() +
geom_smooth(
se = FALSE,
col = "red",
lty = 2,
lwd = .25,
alpha = .5
)
rf_grid_5 <- expand.grid(.mtry = 1:ncol(predictors_5))
set.seed(348)
rf_model_5 <- caret::train(
x = predictors_5,
y = responses$hill.one.avg,
method = "rf",
tuneGrid = rf_grid_5,
trControl = ctrl,
ntree = 1000
)
rf_model_5$results
# average RMSE plot
ggplot(rf_model_5) +
theme(legend.position = "top")
# obs vs predicted plot
rf_model_5_pred <- rf_model_5$pred
ggplot(rf_model_5_pred, aes(x = pred, y = obs)) +
geom_abline(col = "green", alpha = .5) +
geom_hex(alpha = .8) +
scale_fill_viridis_c() +
geom_smooth(
se = FALSE,
col = "red",
lty = 2,
lwd = .25,
alpha = .5
)
rf_model_5$finalModel
rf_grid_10 <- expand.grid(.mtry = 1:ncol(predictors_10))
set.seed(38)
rf_model_10 <- caret::train(
x = predictors_10,
y = responses$hill.one.avg,
method = "rf",
tuneGrid = rf_grid_10,
trControl = ctrl,
ntree = 1000
)
rf_model_10$results
# average RMSE plot
ggplot(rf_model_10) +
theme(legend.position = "top")
# obs vs predicted plot
rf_model_10_pred <- rf_model_10$pred
ggplot(rf_model_10_pred, aes(x = pred, y = obs)) +
geom_abline(col = "green", alpha = .5) +
geom_hex(alpha = .8) +
scale_fill_viridis_c() +
geom_smooth(
se = FALSE,
col = "red",
lty = 2,
lwd = .25,
alpha = .5
)
rf_model_10$finalModel
rf_grid_25 <- expand.grid(.mtry = 1:ncol(predictors_25))
set.seed(38)
rf_model_25 <- caret::train(
x = predictors_25,
y = responses$hill.one.avg,
method = "rf",
tuneGrid = rf_grid_25,
trControl = ctrl,
ntree = 1000
)
rf_model_25$results
# average RMSE plot
ggplot(rf_model_25) +
theme(legend.position = "top")
# obs vs predicted plot
rf_model_25_pred <- rf_model_25$pred
ggplot(rf_model_25_pred, aes(x = pred, y = obs)) +
geom_abline(col = "green", alpha = .5) +
geom_hex(alpha = .8) +
scale_fill_viridis_c() +
geom_smooth(
se = FALSE,
col = "red",
lty = 2,
lwd = .25,
alpha = .5
)
rf_grid_25
rf_model_25$finalModel
rf_grid_25 <- expand.grid(.mtry = 1:ncol(predictors_25))
set.seed(25)
rf_model_25 <- caret::train(
x = predictors_25,
y = responses$hill.one.avg,
method = "rf",
tuneGrid = rf_grid_25,
trControl = ctrl,
ntree = 1000
)
rf_model_25$results
# average RMSE plot
ggplot(rf_model_25) +
theme(legend.position = "top")
# obs vs predicted plot
rf_model_25_pred <- rf_model_25$pred
ggplot(rf_model_25_pred, aes(x = pred, y = obs)) +
geom_abline(col = "green", alpha = .5) +
geom_hex(alpha = .8) +
scale_fill_viridis_c() +
geom_smooth(
se = FALSE,
col = "red",
lty = 2,
lwd = .25,
alpha = .5
)
sqrt(50)
sqrt(25)
sqrt(157)
rf_model_25$finalModel
### 50 predictor model -----
rf_grid_50 <- expand.grid(.mtry = 1:15)
set.seed(50)
rf_model_50 <- caret::train(
x = predictors_50,
y = responses$hill.one.avg,
method = "rf",
tuneGrid = rf_grid_50,
trControl = ctrl,
ntree = 1000
)
rf_model_50$results
# average RMSE plot
ggplot(rf_model_50) +
theme(legend.position = "top")
# obs vs predicted plot
rf_model_50_pred <- rf_model_50$pred
ggplot(rf_model_50_pred, aes(x = pred, y = obs)) +
geom_abline(col = "green", alpha = .5) +
geom_hex(alpha = .8) +
scale_fill_viridis_c() +
geom_smooth(
se = FALSE,
col = "red",
lty = 2,
lwd = .25,
alpha = .5
)
rf_model_50$finalModel
?load
mod <- load(here("archive", "model_output_11-12", "mean.pi.avg.rda"))
load(here("archive", "model_output_11-12", "mean.pi.avg.rda"))
mod$finalModel
load(here("archive", "model_output_11-12", "hill.one.avg.rda"))
mod$method
mod$finalModel
load(here("archive", "model_output_11-12", "hill.two.avg.rda"))
mod$finalModel
load(here("archive", "model_output_11-12", "hill.three.avg.rda"))
mod$finalModel
load(here("archive", "model_output_11-12", "cell.rda"))
mod$finalModel
plot(mod)
mod_pred <- mod$pred
ggplot(mod_pred, aes(x = pred, y = obs)) +
geom_abline(col = "green", alpha = .5) +
geom_hex(alpha = .8) +
scale_fill_viridis_c() +
geom_smooth(
se = FALSE,
col = "red",
lty = 2,
lwd = .25,
alpha = .5
)
load(here("archive", "model_output_11-12", "latitude.rda"))
mod_pred <- mod$pred
ggplot(mod_pred, aes(x = pred, y = obs)) +
geom_abline(col = "green", alpha = .5) +
geom_hex(alpha = .8) +
scale_fill_viridis_c() +
geom_smooth(
se = FALSE,
col = "red",
lty = 2,
lwd = .25,
alpha = .5
)
mod$finalModel
load(here("archive", "model_output_11-12", "longitude.rda"))
mod$finalModel
load(here("archive", "model_output_11-12", "mean.pi.avg.rda"))
mod$finalModel
load(here("archive", "model_output_11-12", "median.pi.avg.rda"))
mod$finalModel
load(here("archive", "model_output_11-12", "sd.pi.avg.rda"))
mod$finalModel
load(here("archive", "model_output_11-12", "hill.4.avg.rda"))
load(here("archive", "model_output_11-12", "hill.four.avg.rda"))
mod$finalModel
load(here("archive", "model_output_11-12", "hill.five.avg.rda"))
mod$finalModel
load(here("archive", "model_output_11-12", "hill.six.avg.rda"))
mod$finalModel
load(here("archive", "model_output_11-12", "hill.seven.avg.rda"))
mod$finalModel
load(here("archive", "model_output_11-12", "hill.eight.avg.rda"))
mod$finalModel
cor(responses$hill.one.avg, predictors$abs_lat)
cor(responses$hill.one.avg, predictors$abs_long)
cor(responses$hill.one.avg, responses$abs_long)
head(predictors$abs_lat)
hist(predictors$abs_lat)
hist(full_df$latitude)
predictors_north <- full_df %>%
na.omit() %>%
filter(latitude > 0) %>%
dplyr::select(
abs_lat,
starts_with("chelsa"),
starts_with("dhi"),
starts_with("hetero"),
starts_with("pc"),
starts_with("soil")
)
responses_north <- full_df %>%
filter(latitude > 0) %>%
na.omit() %>%
dplyr::select(cell,
abs_lat,
abs_long,
contains("avg"),
contains("sd"),
contains("skew"))
mars_model_north <- caret::train(
x = predictors_north,
y = responses_north$hill.one.avg,
method = "earth",
tuneGrid = mars_grid,
trControl = ctrl
)
# average RMSE plot
ggplot(mars_model_north) +
theme(legend.position = "top")
# obs vs predicted plot
mars_model_north_pred <- mars_model_north$pred
ggplot(mars_model_north_pred, aes(x = pred, y = obs)) +
geom_abline(col = "green", alpha = .5) +
geom_hex(alpha = .8) +
scale_fill_viridis_c() +
geom_smooth(
se = FALSE,
col = "red",
lty = 2,
lwd = .25,
alpha = .5
)
mars_model_north$finalModel
### Southern hemisphere -----
# N = 488
predictors_south <- full_df %>%
na.omit() %>%
filter(latitude < 0) %>%
dplyr::select(
abs_lat,
starts_with("chelsa"),
starts_with("dhi"),
starts_with("hetero"),
starts_with("pc"),
starts_with("soil")
)
responses_south <- full_df %>%
filter(latitude < 0) %>%
na.omit() %>%
dplyr::select(cell,
abs_lat,
abs_long,
contains("avg"),
contains("sd"),
contains("skew"))
mars_model_south <- caret::train(
x = predictors_south,
y = responses_south$hill.one.avg,
method = "earth",
tuneGrid = mars_grid,
trControl = ctrl
)
# average RMSE plot
ggplot(mars_model_south) +
theme(legend.position = "top")
ggplot(mars_model_south_pred, aes(x = pred, y = obs)) +
geom_abline(col = "green", alpha = .5) +
geom_hex(alpha = .8) +
scale_fill_viridis_c() +
geom_smooth(
se = FALSE,
col = "red",
lty = 2,
lwd = .25,
alpha = .5
)
# obs vs predicted plot
mars_model_south_pred <- mars_model_south$pred
ggplot(mars_model_south_pred, aes(x = pred, y = obs)) +
geom_abline(col = "green", alpha = .5) +
geom_hex(alpha = .8) +
scale_fill_viridis_c() +
geom_smooth(
se = FALSE,
col = "red",
lty = 2,
lwd = .25,
alpha = .5
)
mars_model_south$finalModel
hist(full_df$longitude)
### Western hemisphere -----
# N = 151
predictors_west <- full_df %>%
na.omit() %>%
filter(longitude < 0) %>%
dplyr::select(
abs_lat,
starts_with("chelsa"),
starts_with("dhi"),
starts_with("hetero"),
starts_with("pc"),
starts_with("soil")
)
responses_west <- full_df %>%
filter(longitude < 0) %>%
na.omit() %>%
dplyr::select(cell,
abs_lat,
abs_long,
contains("avg"),
contains("sd"),
contains("skew"))
mars_model_west <- caret::train(
x = predictors_west,
y = responses_west$hill.one.avg,
method = "earth",
tuneGrid = mars_grid,
trControl = ctrl
)
# average RMSE plot
ggplot(mars_model_west) +
theme(legend.position = "top")
# obs vs predicted plot
mars_model_west_pred <- mars_model_west$pred
ggplot(mars_model_west_pred, aes(x = pred, y = obs)) +
geom_abline(col = "green", alpha = .5) +
geom_hex(alpha = .8) +
scale_fill_viridis_c() +
geom_smooth(
se = FALSE,
col = "red",
lty = 2,
lwd = .25,
alpha = .5
)
mars_model_west$finalModel
### Eastern hemisphere -----
# N = 328
predictors_east <- full_df %>%
na.omit() %>%
filter(longitude > 0) %>%
dplyr::select(
abs_lat,
starts_with("chelsa"),
starts_with("dhi"),
starts_with("hetero"),
starts_with("pc"),
starts_with("soil")
)
responses_east <- full_df %>%
filter(longitude > 0) %>%
na.omit() %>%
dplyr::select(cell,
abs_lat,
abs_long,
contains("avg"),
contains("sd"),
contains("skew"))
mars_model_east <- caret::train(
x = predictors_east,
y = responses_east$hill.one.avg,
method = "earth",
tuneGrid = mars_grid,
trControl = ctrl
)
# average RMSE plot
ggplot(mars_model_east) +
theme(legend.position = "top")
# obs vs predicted plot
mars_model_east_pred <- mars_model_east$pred
ggplot(mars_model_east_pred, aes(x = pred, y = obs)) +
geom_abline(col = "green", alpha = .5) +
geom_hex(alpha = .8) +
scale_fill_viridis_c() +
geom_smooth(
se = FALSE,
col = "red",
lty = 2,
lwd = .25,
alpha = .5
)
mars_model_east$finalModel
View(mars_model_pred_full)
full_mars_model$finalModel$selected.terms
full_mars_model$finalModel
full_mars_model$perfNames
summary(full_mars_model$finalModel)
?sf::st_intersects
?seqinr::as.alignment
?seqinr::dist.alignment
